name: Benchmark weights

on:
  workflow_dispatch:
  pull_request:
    types: [ labeled ]

env:
  CARGO_TERM_COLOR: always

jobs:
  benchmark: 
    name: Benchmark weights
    if: (github.event_name == 'pull_request' && contains(github.event.pull_request.labels.*.name, 's:benchmark-required')) || github.event_name == 'workflow_dispatch'
    runs-on: ubuntu-latest
    defaults:
      run:
        shell: bash
    steps:
      - name: Comment PR (on failure)
        uses: thollander/actions-comment-pull-request@master
        with:
          message: 'Benchmark completed successfully.
          <details>\n
          <summary>\n
          Results\n
          </summary>\n
          \n
          Some multline\n
          text, that should\n
          be displayed properly\n
          within the result box.\n
          \n
          </details>'
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}